<div class="dashboard-container stagger-in">
  <!-- Welcome Hero -->
  <div class="hero-section">
    <div class="hero-content">
      <h1 class="gradient-text">ğŸ‘‹ Bonjour</h1>
      <p class="subtitle">Voici ce qui se passe aujourd'hui sur Sahara Reservations.</p>
    </div>
    <div class="hero-actions">
      <button class="btn-glass-primary" (click)="exportToPDF()">
        ğŸ“¥ Exporter en PDF
      </button>
    </div>
  </div>

  <!-- Filters & Search -->
  <div class="filters-bar">
    <div class="search-wrapper">
      <span class="search-icon">ğŸ”</span>
      <input type="text" 
             [(ngModel)]="searchTerm" 
             (input)="applyFilters()" 
             placeholder="Rechercher une rÃ©servation..." 
             class="glass-input">
    </div>
    
    <div class="filter-group">
      <div class="select-wrapper">
        <select [(ngModel)]="statusFilter" (change)="applyFilters()" class="glass-select">
          <option value="all">Tous Status</option>
          <option value="pending">En attente</option>
          <option value="confirmed">ConfirmÃ©</option>
          <option value="arrived">ArrivÃ©</option>
        </select>
      </div>

      <div class="select-wrapper">
        <select [(ngModel)]="tourTypeFilter" (change)="applyFilters()" class="glass-select">
          <option value="all">Tous Types de Tour</option>
          <option *ngFor="let tourType of tourTypes" [value]="tourType">
            {{ tourType }}
          </option>
        </select>
      </div>

      <div class="date-toggles">
        <button class="btn-toggle" [class.active]="!startDate" (click)="resetFilters()">Tous</button>
        <button class="btn-toggle" [class.active]="startDate" (click)="filterToday()">Aujourd'hui</button>
      </div>
    </div>
  </div>

  <!-- Reservations Table -->
  <lib-glass-card class="table-card">
    <div class="card-header">
      <h3>ğŸ“ RÃ©servations RÃ©centes</h3>
      <span class="badge-count">{{ filteredReservations.length }}</span>
    </div>

    <div class="table-responsive">
      <table class="premium-table">
        <thead>
          <tr>
            <th>Partenaire</th>
            <th>Type de Tour</th>
            <th>Client</th>
            <th>Dates</th>
            <th>Source</th>
            <th>Statut</th>
            <th>Paiement</th>
            <th class="text-right">Montant</th>
            <th class="text-right">Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let r of pagedReservations" class="table-row">
            <td>
              <div class="partner-info">
                <div class="partner-avatar">{{ r.partnerName.charAt(0) }}</div>
                <span>{{ r.partnerName }}</span>
              </div>
            </td>
            <td>
              <span class="tour-type-badge">{{ r.tourType }}</span>
            </td>
            <td>
              <span class="guest-info">ğŸ‘¥ {{ r.numberOfPeople }} pers.</span>
            </td>
            <td>
              <div class="date-col">
                <span class="date-main">{{ formatDate(r.checkInDate) }}</span>
                <span class="date-sub">{{ calculateDuration(r) }} nuits</span>
              </div>
            </td>
            <td>
              <span class="source-badge">{{ r.source }}</span>
            </td>
            <td><lib-status-badge [status]="r.status"></lib-status-badge></td>
            <td>
              <div class="payment-indicator">
                <div class="progress-mini">
                  <div class="fill" [style.width.%]="(r.payment.paidAmount / r.payment.totalAmount) * 100"></div>
                </div>
                <span class="payment-text">{{ getPaymentStatusLabel(r.payment.paymentStatus) }}</span>
              </div>
            </td>
            <td class="text-right font-bold">{{ r.payment.totalAmount }} TND</td>
            <td class="text-right">
              <div class="actions-flex">
                <button class="btn-icon view" [routerLink]="['/reservation', r.id]" title="Voir">ğŸ‘ï¸</button>
                <button *ngIf="r.status === 'pending'" class="btn-icon check" (click)="confirmReservation(r.id)" title="Confirmer">âœ…</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      
      <div *ngIf="filteredReservations.length === 0" class="empty-state">
        <div class="empty-icon">ğŸŒµ</div>
        <p>Aucune rÃ©servation trouvÃ©e pour le moment.</p>
      </div>
    </div>

    <!-- Pagination -->
    <div *ngIf="filteredReservations.length > 0" class="pagination">
      <button 
        class="pagination-btn" 
        [disabled]="currentPage === 1"
        (click)="goToPage(currentPage - 1)"
      >
        â† PrÃ©cÃ©dent
      </button>
      
      <div class="pagination-info">
        <span>Page {{ currentPage }} sur {{ totalPages }}</span>
        <span class="separator">|</span>
        <span>{{ filteredReservations.length }} rÃ©sultats</span>
      </div>
      
      <button 
        class="pagination-btn" 
        [disabled]="currentPage === totalPages"
        (click)="goToPage(currentPage + 1)"
      >
        Suivant â†’
      </button>
    </div>
  </lib-glass-card>
</div>